<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>Référence Python 3 et Interface graphique Tkinter, OptionMenu</title>
    <meta content="A. Oumnad" name="author">
    <meta content="Mini référence pour le langage de programmation Python 3 et l'interface graphique Tkinter" name="description">
    <meta content="Python, Python3, Python 3, Tkinter, interface graphique, GUI, Tkinter GUI, OptionMenu" name="keywords">
    <link rel="shortcut icon" type="image/png" href="images/py.png" \="">
    <style type="text/css">
        #titre {  
          background-color: #ccccff;  
        }
      
        #soustitre {  
          background-color: #80cc90;
          font-style: italic; 
          font-size: xx-large; 
          font-weight: bold; 
          text-align: center; 
          color: #990000;
        }
        
        #navigation {  
          width: 23%; 
          min-height: 1000px;
          float: left;  
          font-family: Cambria;
        }
        
        #contenu{  
          width: 72%;
          min-height: 1000px;
          float: right;  
          background-color: #ffff99;  
          font-family: Cambria;
          padding: 10px;
          margin-top: 10px;
          text-align: justify;
          }
      
        #icone{
         width: 7%;
         float: left; 
         margin: 3px;
         }
      
     </style>
  </head>
  <body style="       background-color: silver; width: 99%; height: 100%;">
    <table style="width: 100%; font-family: Cambria;" border="0">
      <tbody>
        <tr id="titre">
          <td> <img id="icone" alt="" src="images/python.jpg">
            <h1 style="text-align: center;"><em>Le langage <span style="color: #990000;">python 3</span> et l'Interface
                Graphique <span style="color: #990000;">Tkinter</span><br>
              </em></h1>
            <h1> </h1>
          </td>
        </tr>
        <tr id="soustitre">
          <td>Le widget OptionMenu<br>
          </td>
        </tr>
      </tbody>
    </table>
    <object id="navigation" data="python3_sommaire.html"></object>
    <div id="contenu"> Ce widget permet de sélectionner une valeur dans une liste déroulante.
      <p><span style="font-family: Cambria;">La valeur courante (sélectionnée) est</span><span style="font-family: Cambria;">
          affichée sur le widget. Elle est liée à une variable de type <em>StringVar()</em>, elle peut être positionnée
          par code: <em style="color: #000099; font-weight: bold;">variable.set(valeur)</em> et lue par <em style="color: #000099; font-weight: bold;">valeur
            = variable.get()</em></span></p>
      <span style="font-family: Cambria;"></span><span style="font-family: Cambria;"></span><span style="color: #990000;"><em><span
            style="font-family: Cambria;">Syntaxe:</span></em></span> <span style="color: red;"><em><span style="font-family: Cambria;"></span></em></span>
      <table style="width: 100%;" border="1" cellpadding="10">
        <tbody>
          <tr>
            <td style="background-color: #9999ff;"><em><span style="font-family: Cambria;">baudvar =
                  StringVar()&nbsp;&nbsp;&nbsp; &nbsp; # variable liée au widget</span></em><em><img style="float: right;"
                  alt="optionmenu" src="images/optionmenu0.PNG"><img style="float: left; margin: 0cm 0.3cm;" alt="" src="images/OptionMenu00.PNG"><br>
              </em><em><span style="font-family: Cambria;">baudvar.set('9600')&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; #
                  valeur courante (initiale) qui sera affichée</span></em><em><br>
              </em><em> </em><em><span style="font-family: Cambria;">baudmenu = OptionMenu(fp, baudvar, '4800' , '9600'
                  , '19200' , '38400')</span></em><em><br>
              </em><em> </em><em><span style="font-family: Cambria;">baudmenu.configure(width = 10, bg='pink',
                  borderwidth =5)</span></em><em><br>
              </em><em> </em> <span style="font-family: Cambria;"></span></td>
          </tr>
        </tbody>
      </table>
      <p><span style="font-family: Cambria;"></span></p>
      <h3><span style="color: #990000;"><em><span style="font-family: Cambria;">Quelques options du widget OptionMenu</span></em></span></h3>
      <p><span style="font-family: Cambria;">A part l'option <strong><em>command</em></strong> qui doit être précisée
          entre parenthèses au moment de la création du widget, les autres options peuvent être définie à l'aide de la
          méthode <em style="color: #000099; font-weight: bold;">nom_widget.configure(option=valeur, . . .)</em></span></p>
      <dl>
        <dt><span style="font-family: Cambria;">&nbsp;</span></dt>
      </dl>
      <table style="width: 95%;" border="1" cellpadding="10" cellspacing="0">
        <tbody>
          <tr>
            <td style="width: 140px"><span style="font-family: Cambria;"><strong><em>command</em></strong></span><br>
            </td>
            <td style="width: 480px"> <span style="font-family: Cambria;">Pour préciser la fonction qui sera exécutée
                chaque fois qu'on sélectionne une valeur dans la liste.</span> La fonction doit avoir un paramètre qui
              recevra la valeur sélectionnée<br>
            </td>
          </tr>
          <tr>
            <td style="width: 140px"> <span style="font-family: Cambria;"><strong><em>background (bg)</em></strong></span><br>
            </td>
            <td style="width: 480px"> <span style="font-family: Cambria;"><a href="python3_couleurs.html">Couleur </a>du
                widget "red", "blue", "green", "yellow", . . . ou #rrvvbb</span><br>
            </td>
          </tr>
          <tr>
            <td style="width: 140px"> <span style="font-family: Cambria;"><strong><em>borderwidth&nbsp; (bd)</em></strong></span><br>
            </td>
            <td style="width: 480px"> <span style="font-family: Cambria;">Epaisseur de la bordure en pixels. Améliore
                l'effet de relief , Défaut=2.</span><br>
            </td>
          </tr>
          <tr>
            <td style="width: 140px"> <span style="font-family: Cambria;"><strong><em>width</em></strong></span><br>
            </td>
            <td style="width: 480px"> <span style="font-family: Cambria;">Largeur du widget en caractère</span><br>
            </td>
          </tr>
        </tbody>
      </table>
      <br>
      <span style="font-family: Cambria;">Dans l'<a href="scriptes/OptionMenu.py">exemple </a>ci-dessous, on a deux
        widgets OptionMenu, portmenu et baudmenu.</span><br>
      <ul>
        <li>Si on sélectionne une valeur dans <em>portmenu</em>, la fonction <em>portchange(x) </em>est invoquée en
          recevant comme paramètre la valeur sélectionnée. Celle ci est affichée dans le label L1</li>
        <li>Si on sélectionne une valeur dans <em>baudmenu</em>, la fonction <em>baudchange(x) </em>est invoquée en
          recevant comme paramètre la valeur sélectionnée. Celle ci est affichée dans le label <em>L1</em></li>
        <li>Si on clique le bouton vérifier, on invoque la fonction <em>verif()</em> qui récupère les valeurs courantes
          des deux obtionMenus à l'aides des variables associées et les affiche dans le label <em>L1</em></li>
      </ul>
      <span style="font-family: Cambria;">Cet exemple utilise le positionneur <em>grid()</em> <br>
      </span><br>
      <table style="width: 100%;" border="0" cellpadding="10">
        <tbody>
          <tr>
            <td style="background-color: #9999ff;"><em>from tkinter import *</em><br>
              <img style="float: right;" alt="" src="images/OptionMenu1.PNG"><em><br>
              </em><em>def portchange(valeur):</em><em><br>
              </em><em>&nbsp;&nbsp;&nbsp; L1.configure(text= "Port = " + valeur, bg='green')</em><em><br>
              </em><em><br>
              </em><em>def baudchange(valeur):</em><em><br>
              </em><em>&nbsp;&nbsp;&nbsp; L1.configure(text= "Vitesse = " + valeur, bg='cyan')</em><em><br>
              </em><em>&nbsp;</em><em><br>
              </em><em>def verif():</em><em><br>
              </em><em>&nbsp;&nbsp;&nbsp; L1.configure(text= "Port = " + portstr.get()+"\nVitesse = " + baudstr.get(),
                bg='yellow')</em><em><br>
              </em><em>&nbsp;&nbsp;&nbsp; </em><em><br>
              </em><em>fp=Tk()</em><em><br>
              </em><em>portstr = StringVar()</em><em><br>
              </em><em>baudstr = StringVar()</em><em><br>
              </em><em>portstr.set('COM1')</em><em><br>
              </em><em>baudstr.set('9600')</em><em><br>
              </em><em>portmenu = OptionMenu(fp, portstr, 'COM1', 'COM2', 'COM3', 'COM4', 'COM5', 'COM6', command =
                portchange)</em><em><br>
              </em><em>baudmenu = OptionMenu(fp, baudstr, '4800', '9600', '19200', '38400', command = baudchange)</em><em><br>
              </em><em>portmenu.configure(width = 10, bg='pink', bd=5)</em><em><br>
              </em><em>baudmenu.configure(width = 10, bg='pink', bd=5)</em><em><br>
              </em><em>B1 = Button(fp, text = 'Vérifier', command = verif)</em><em><br>
              </em><em>L1 = Label(fp,text='Status',width=20)</em><em><br>
              </em><em>B2 = Button(fp, text="EXIT", command=fp.destroy)</em><em><br>
              </em><em>portmenu.grid(row=1, column=1, sticky='W')</em><em><br>
              </em><em>baudmenu.grid(row=2, column=1, sticky='W')</em><em><br>
              </em><em>B1.grid(row=4, column=1, sticky='W', padx = 10)</em><em><br>
              </em><em>L1.grid(row=1,column=2, pady=5)</em><em><br>
              </em><em>B2.grid(row=5, column=2, pady=10)</em><em><br>
              </em><em>fp.grid_rowconfigure(3, minsize=30)</em><em><br>
              </em><em><br>
              </em><em>fp.mainloop()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </em><em><br>
              </em><em><br>
              </em></td>
          </tr>
        </tbody>
      </table>
      <p><span style="font-family: Cambria;"></span></p>
      <span style="font-family: Cambria;"><br clear="all">
      </span> </div>
    <script language="JavaScript">
         document.getElementById('navigation').height= document.getElementById('contenu').scrollHeight;
    </script>
  </body>
</html>
